{% extends "navigation.html" %}



{% block content %}




{% set foundAppointment = namespace(found=False) %}
{% set i = namespace(number = 0) %}




<form action="/user/{{userId}}" method="POST">
    {{ dateform.hidden_tag() }}
    {{dateform.start_date.label}}
    {{ dateform.start_date() }}
    {{ dateform.submit()}}




    <table>
        <tr>
            <td>Heure</td>
            {% for day in weekdays %}
            <td>{{day[0]}}</td>



            {% endfor %}



        </tr>

        {% for time in times %}

        <tr>

            <td> {{time.strftime("%H:%M")}}</td>

            {% for day in weekdays %}

            {% if appointments == [] %}
            <td> <a href="/appointment/{{day[1].date()}}/{{time.time()}}/{{userId}}"> Prendre rendez-vous</a></td>
            {% else %}


            {% for app in appointments %}

            {% if app.time_start.date() == day[1].date() and app.time_start.time() == time.time() %}
            {% set foundAppointment.found = True %}
                {% if confirmations[i.number] %}
                <td style="background-color: green;">{{ app.title}} <br>
                    Date:{{ app.time_start.day }}/{{app.time_start.month}}/{{app.time_start.year}} <br>
                    Heure: {{app.time_start.time()}} - {{app.time_end.time()}} </td>

                {% elif not confirmations[i.number] %}
                 <td style="background-color:  rgba(255, 159, 0, 0.1);">{{ app.title}} <br>
                    Date:{{ app.time_start.day }}/{{app.time_start.month}}/{{app.time_start.year}} <br>
                    Heure: {{app.time_start.time()}} - {{app.time_end.time()}} </td>

                {% endif %}

            {% endif %}



            {% endfor %}

            {% if not foundAppointment.found %}
            <td style="background-color: rgba(0, 123, 255, 0.1);"> </td>

            {% endif %}
            {% set foundAppointment.found=False %}

            {% endif %}
            {% endfor %}

        </tr>
        {% endfor %}






    </table>

    {% endblock %}