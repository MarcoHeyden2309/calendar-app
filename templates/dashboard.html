{% extends "navigation.html" %}



{% block content %}




{% set foundAppointment = namespace(found=False) %}
{% set i = namespace(number = 0) %}




<form action="/dashboard" method="POST">
    {{ dateform.hidden_tag() }}
    {{dateform.start_date.label}}
    {{ dateform.start_date() }}
    {{ dateform.submit()}}




    <table>
        <tr>
            <td>Heure</td>
            {% for day in weekdays %}
            <td>{{day[0]}}</td>



            {% endfor %}



        </tr>

        {% for time in times %}

        <tr>

            <td> {{time.strftime("%H:%M")}}</td>

            {% for day in weekdays %}

            {% if appointments == [] %}
            <td style="background-color: rgba(0, 123, 255, 0.1);"> </td>
            {% else %}


            {% for app in appointments %}

            {% if app.time_start.date() == day[1].date() and app.time_start.time() == time.time() %}
            {% set foundAppointment.found = True %}
                {% if confirmations[i.number] %}
                <td style="background-color: green;">{{ app.title}} <br>
                    Date:{{ app.time_start.day }}/{{app.time_start.month}}/{{app.time_start.year}} <br>
                    Heure: {{app.time_start.time()}} - {{app.time_end.time()}} 
                    number: {{i.number}}
                    bool: {{confirmations[i.number]}}
                </td>

                    {% set i.number = i.number+1 %}
                    
                {% elif not confirmations[i.number] %}
                 <td style="background-color:  rgba(255, 157, 0, 0.253);">{{ app.title}} <br>
                    Date:{{ app.time_start.day }}/{{app.time_start.month}}/{{app.time_start.year}} <br>
                    Heure: {{app.time_start.time()}} - {{app.time_end.time()}} 
                    number: {{i.number}}
                    bool: {{confirmations[i.number]}}
                    <br>
                    {% if userId != app.creatorId %}
                        <button onclick="window.location.href='/confirm/{{app.id}}/2';">Confirm</button>
                   
                    
                        <button onclick="window.location.href='/confirm/{{app.id}}/1';">Decline</button>
                    
                    {% endif %}
                    {% set i.number = i.number+1 %}
                </td>

                {% endif %}
                

            {% endif %}

                

            {% endfor %}
            

            {% if not foundAppointment.found %}
            <td style="background-color: rgba(0, 123, 255, 0.1);"> </td>

            {% endif %}
            {% set foundAppointment.found=False %}

            {% endif %}
            {% endfor %}

        </tr>
        {% endfor %}






    </table>
    {% set i.number = 0 %}
    {% endblock %}